CREATE OR REPLACE PROCEDURE PRO(P_ID IN NUMBER,P_CUSTOMER_NAME IN VARCHAR2)
IS
REF_CURSOR SYS_REFCURSOR;
V_VCH_CUSTOMER_ID  CUSTOMERS_DEMO.CUSTOMER_ID%TYPE;
V_VCH_CUSTOMER_NAME  CUSTOMERS_DEMO.CUSTOMER_NAME%TYPE;
V_VCH_CUSTOMER_ADDRESS CUSTOMERS_DEMO.CUSTOMER_ADDRESS%TYPE;
BEGIN
OPEN REF_CURSOR FOR 'SELECT CUSTOMER_ID, CUSTOMER_NAME,CUSTOMER_ADDRESS  FROM CUSTOMERS_DEMO WHERE CUSTOMER_ID= :P_ID OR CUSTOMER_NAME=:P_CUSTOMER_NAME' USING P_ID,P_CUSTOMER_NAME ;
LOOP
FETCH REF_CURSOR INTO V_VCH_CUSTOMER_ID,V_VCH_CUSTOMER_NAME,V_VCH_CUSTOMER_ADDRESS;
EXIT WHEN REF_CURSOR%NOTFOUND;
DBMS_OUTPUT.PUT_LINE('ID: '||V_VCH_CUSTOMER_ID||' ,NAME:  '||V_VCH_CUSTOMER_NAME||' ,ADDRESS:  '||V_VCH_CUSTOMER_ADDRESS);
END LOOP;
CLOSE REF_CURSOR;
END;


//////////////////////


CREATE OR REPLACE PROCEDURE DYNAMICCURSOR(P_ID IN NUMBER,P_CUSTOMER_NAME IN VARCHAR)
AS
V_VCH_CUSTOMER_ID  CUSTOMERS_DEMO.CUSTOMER_ID%TYPE;
V_VCH_CUSTOMER_NAME  CUSTOMERS_DEMO.CUSTOMER_NAME%TYPE;
V_VCH_CUSTOMER_ADDRESS CUSTOMERS_DEMO.CUSTOMER_ADDRESS%TYPE;
CURSOR C_CURSOR1 IS SELECT * FROM CUSTOMERS_DEMO WHERE CUSTOMER_ID=P_ID;
CURSOR C_CURSOR2 IS SELECT * FROM CUSTOMERS_DEMO WHERE CUSTOMER_NAME=P_CUSTOMER_NAME;
BEGIN
OPEN C_CURSOR1;
OPEN C_CURSOR2;
LOOP
FETCH C_CURSOR1 INTO V_VCH_CUSTOMER_ID,V_VCH_CUSTOMER_NAME,V_VCH_CUSTOMER_ADDRESS;
DBMS_OUTPUT.PUT_LINE('ID: '||P_ID||', '||'NAME:'||V_VCH_CUSTOMER_NAME||', ADDRESS'||V_VCH_CUSTOMER_ADDRESS);
FETCH C_CURSOR2 INTO V_VCH_CUSTOMER_ID,V_VCH_CUSTOMER_NAME,V_VCH_CUSTOMER_ADDRESS;
DBMS_OUTPUT.PUT_LINE('ID: '||P_ID||', '||'NAME:'||V_VCH_CUSTOMER_NAME||', ADDRESS'||V_VCH_CUSTOMER_ADDRESS);
END LOOP;
CLOSE C_CURSOR1;
CLOSE C_CURSOR2;
END;



///////////////////

CREATE OR REPLACE PROCEDURE PRO(P_CUSTOMER_ID IN NUMBER:=NULL ,P_CUSTOMER_NAME IN VARCHAR2:=NULL)
IS
REF_CURSOR SYS_REFCURSOR;
V_VCH_CUSTOMER_ID  NUMBER;
V_VCH_CUSTOMER_NAME  VARCHAR2(30);
V_VCH_CUSTOMER_ADDRESS VARCHAR2(50);
V_VCH_SQL_QUERY VARCHAR(300);
V_VCH_CUSTOMER_ID_COUNT NUMBER;

BEGIN

    IF P_CUSTOMER_ID IS NOT NULL THEN
        SELECT COUNT(*) INTO V_VCH_CUSTOMER_ID_COUNT FROM CUSTOMERS_DEMO WHERE CUSTOMER_ID = P_CUSTOMER_ID;
        IF V_VCH_CUSTOMER_ID_COUNT =0 THEN
            DBMS_OUTPUT.PUT_LINE('NO DATA PRESENT IN THIS ID');
        END IF;
    END IF;

    V_VCH_SQL_QUERY := 'SELECT CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS FROM CUSTOMERS_DEMO ';
    IF P_CUSTOMER_ID IS NOT NULL THEN
        V_VCH_SQL_QUERY := V_VCH_SQL_QUERY ||'WHERE CUSTOMER_ID = ' || P_CUSTOMER_ID;
    ELSIF P_CUSTOMER_NAME IS NOT NULL THEN
        V_VCH_SQL_QUERY := V_VCH_SQL_QUERY || 'WHERE CUSTOMER_NAME' || P_CUSTOMER_NAME;
    ELSE
        V_VCH_SQL_QUERY := V_VCH_SQL_QUERY;
        DBMS_OUTPUT.PUT_LINE('ALL RECORDS');
    END IF;
    OPEN REF_CURSOR FOR V_VCH_SQL_QUERY;
    LOOP
        FETCH REF_CURSOR INTO V_VCH_CUSTOMER_ID, V_VCH_CUSTOMER_NAME, V_VCH_CUSTOMER_ADDRESS;
        EXIT WHEN REF_CURSOR%NOTFOUND;
        DBMS_OUTPUT.PUT_LINE('ID: ' || V_VCH_CUSTOMER_ID || ', Name: ' || V_VCH_CUSTOMER_NAME || ', ADDRESS: ' || V_VCH_CUSTOMER_ADDRESS);
    END LOOP;
    CLOSE REF_CURSOR;
END;

